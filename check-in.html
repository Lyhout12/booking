<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Check-in - Hotel Booking</title>
     <link rel="icon" href="img/download (2).png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="stylesheet" href="check-in.css">
    <link href="https://fonts.googleapis.com/css2?family=Ancizar+Serif:ital,wght@0,300..900;1,300..900&family=Playwrite+NG+Modern:wght@100..400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4Q6Gf2aSP4eDXB8Miphtr37CMZZQ5oXLH2yaXMJ2w8e2ZtHTl7GptT4jmndRuHDT" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
</head>
<body>
    <div class="booking-container">
        <div class="booking-card">
            <div class="booking-header">
                <h1 class="booking-title">Complete Your Booking</h1>
                <p>Fill in your details to confirm your stay</p>
            </div>
            
            <div class="hotel-info">
                <!-- <div class="hotel-name" id="selectedHotelName">Hotel Name</div> -->
                <div class="hotel-price" id="selectedHotelPrice">$0 / night</div>
            </div>
            
            <div class="date-section">
                <div class="date-display">
                    <div class="date-column">
                        <label for="checkInDate">Check-In Date</label>
                        <input type="date" class="date-input" id="checkInDate">
                        <div class="date-formatted" id="checkInFormatted">Select date</div>
                    </div>
                    <div class="date-column">
                        <label for="checkOutDate">Check-Out Date</label>
                        <input type="date" class="date-input" id="checkOutDate">
                        <div class="date-formatted" id="checkOutFormatted">Select date</div>
                    </div>
                </div>
            </div>
            
            <div class="guest-section">
                <div class="guest-control">
                    <div>
                        <div class="guest-label">One BedRoom</div>
                        <div class="guest-subtitle">Perfect for solo travelers or couples</div>
                    </div>
                    <div class="counter">
                        <button class="counter-btn" id="decreaseOneBed">-</button>
                        <span class="counter-value" id="oneBedCount">1</span>
                        <button class="counter-btn" id="increaseOneBed">+</button>
                    </div>
                </div>
                
                <div class="guest-control">
                    <div>
                        <div class="guest-label">Two BedRoom</div>
                        <div class="guest-subtitle">Ideal for families or groups</div>
                    </div>
                    <div class="counter">
                        <button class="counter-btn" id="decreaseTwoBed">-</button>
                        <span class="counter-value" id="twoBedCount">0</span>
                        <button class="counter-btn" id="increaseTwoBed">+</button>
                    </div>
                </div>
                
                <div class="guest-control">
                    <div>
                        <div class="guest-label">Adults (Ages 18+)</div>
                        <div class="guest-subtitle">Age 18 and above</div>
                    </div>
                    <div class="counter">
                        <button class="counter-btn" id="decreaseAdults">-</button>
                        <span class="counter-value" id="adultCount">2</span>
                        <button class="counter-btn" id="increaseAdults">+</button>
                    </div>
                </div>
                
                <div class="guest-control">
                    <div>
                        <div class="guest-label">Children (Ages 0-17)</div>
                        <div class="guest-subtitle">Age 0 to 17 years</div>
                    </div>
                    <div class="counter">
                        <button class="counter-btn" id="decreaseChildren">-</button>
                        <span class="counter-value" id="childCount">0</span>
                        <button class="counter-btn" id="increaseChildren">+</button>
                    </div>
                </div>
            </div>
            
            <div class="price-section">
                <div class="price-summary">
                    <h4>Price Summary</h4>
                    <div class="price-item">
                        <span>Price per night:</span>
                        <span id="displayPrice">$0</span>
                    </div>
                    <div class="price-item">
                        <span>Number of nights:</span>
                        <span id="nightsCount">0</span>
                    </div>
                    <div class="price-item">
                        <span>One Bedroom Rooms:</span>
                        <span id="oneBedRoomsCount">1</span>
                    </div>
                    <div class="price-item">
                        <span>Two Bedroom Rooms:</span>
                        <span id="twoBedRoomsCount">0</span>
                    </div>
                    <div class="total-price">
                        <span>Total Price:</span>
                        <span id="totalPrice">$0</span>
                    </div>
                </div>
            </div>
            
            <div class="confirm-section">
                <a href="payment.html">
                     <button class="confirm-btn" id="confirmBtn">
                    <i class="fas fa-check-circle"></i>Confirm Booking & Continue to Payment
                </button>
                </a>
            </div>
            
            <div class="destinations-section">
                <h3 class="destinations-title">Explore Beautiful Cambodia</h3>
                <p style="color: #6b7280; margin: 0;">
                    Discover amazing destinations like Phnom Penh, Siem Reap, and more!
                </p>
            </div>
        </div>
    </div>

    <script>
        // Get URL parameters
        const urlParams = new URLSearchParams(window.location.search);
        // const hotelName = urlParams.get('hotel') || 'Selected Hotel';
        const hotelPrice = parseFloat(urlParams.get('price')) || 0;
        
        // Set hotel info
        // document.getElementById('selectedHotelName').textContent = hotelName;
        document.getElementById('selectedHotelPrice').textContent = `$${hotelPrice.toFixed(2)} / night`;
        document.getElementById('displayPrice').textContent = `$${hotelPrice.toFixed(2)}`;
        
        // Format date as "Friday, Jun 13, 2025"
        function formatDateLong(dateString) {
            const date = new Date(dateString);
            const options = { weekday: 'long', month: 'short', day: 'numeric', year: 'numeric' };
            return date.toLocaleDateString('en-US', options);
        }
        
        // Calculate and update total price
        function calculateTotalPrice() {
            const checkIn = new Date(document.getElementById('checkInDate').value);
            const checkOut = new Date(document.getElementById('checkOutDate').value);
            const oneBedRooms = parseInt(document.getElementById('oneBedCount').textContent);
            const twoBedRooms = parseInt(document.getElementById('twoBedCount').textContent);
            
            if (checkIn && checkOut && checkOut > checkIn) {
                const nights = Math.ceil((checkOut - checkIn) / (1000 * 60 * 60 * 24));
                const totalOneBedPrice = hotelPrice * nights * oneBedRooms;
                const totalTwoBedPrice = (hotelPrice * 1.5) * nights * twoBedRooms; // Two-bedroom costs 1.5x more
                const total = totalOneBedPrice + totalTwoBedPrice;
                
                document.getElementById('nightsCount').textContent = nights;
                document.getElementById('oneBedRoomsCount').textContent = oneBedRooms;
                document.getElementById('twoBedRoomsCount').textContent = twoBedRooms;
                document.getElementById('totalPrice').textContent = `$${total.toFixed(2)}`;
                
                return total;
            } else {
                document.getElementById('nightsCount').textContent = '0';
                document.getElementById('totalPrice').textContent = '$0';
                return 0;
            }
        }
        
        // Update date displays
        function updateDateDisplays() {
            const checkInDate = document.getElementById('checkInDate').value;
            const checkOutDate = document.getElementById('checkOutDate').value;
            
            if (checkInDate) {
                document.getElementById('checkInFormatted').textContent = formatDateLong(checkInDate);
            }
            if (checkOutDate) {
                document.getElementById('checkOutFormatted').textContent = formatDateLong(checkOutDate);
            }
            
            // Validate dates
            const checkIn = new Date(checkInDate);
            const checkOut = new Date(checkOutDate);
            
            if (checkOutDate && checkOut <= checkIn) {
                document.getElementById('checkOutDate').style.borderColor = '#ef4444';
                document.getElementById('checkOutFormatted').style.color = '#ef4444';
            } else {
                document.getElementById('checkOutDate').style.borderColor = '';
                document.getElementById('checkOutFormatted').style.color = '#6b7280';
            }
            
            calculateTotalPrice();
        }
        
        // Initialize date displays
        updateDateDisplays();
        
        // Date change listeners
        document.getElementById('checkInDate').addEventListener('change', updateDateDisplays);
        document.getElementById('checkOutDate').addEventListener('change', updateDateDisplays);
        
        // Counter functionality with animation
        function setupCounter(decBtnId, incBtnId, countId, min = 0, max = 10) {
            const decBtn = document.getElementById(decBtnId);
            const incBtn = document.getElementById(incBtnId);
            const countElement = document.getElementById(countId);
            
            const updateButtons = () => {
                const count = parseInt(countElement.textContent);
                decBtn.disabled = count <= min;
                incBtn.disabled = count >= max;
            };
            
            decBtn.addEventListener('click', () => {
                let count = parseInt(countElement.textContent);
                if (count > min) {
                    countElement.textContent = count - 1;
                    countElement.classList.add('changed');
                    setTimeout(() => countElement.classList.remove('changed'), 300);
                    updateButtons();
                    calculateTotalPrice();
                }
            });
            
            incBtn.addEventListener('click', () => {
                let count = parseInt(countElement.textContent);
                if (count < max) {
                    countElement.textContent = count + 1;
                    countElement.classList.add('changed');
                    setTimeout(() => countElement.classList.remove('changed'), 300);
                    updateButtons();
                    calculateTotalPrice();
                }
            });
            
            // Initialize button states
            updateButtons();
        }
        
        setupCounter('decreaseOneBed', 'increaseOneBed', 'oneBedCount', 0, 5);
        setupCounter('decreaseTwoBed', 'increaseTwoBed', 'twoBedCount', 0, 5);
        setupCounter('decreaseAdults', 'increaseAdults', 'adultCount', 1, 10);
        setupCounter('decreaseChildren', 'increaseChildren', 'childCount', 0, 8);
        
        // Confirm button functionality
        document.getElementById('confirmBtn').addEventListener('click', () => {
            const checkIn = document.getElementById('checkInDate').value;
            const checkOut = document.getElementById('checkOutDate').value;
            
            if (!checkIn || !checkOut) {
                alert('Please select both check-in and check-out dates');
                return;
            }
            
            const checkInDate = new Date(checkIn);
            const checkOutDate = new Date(checkOut);
            
            if (checkOutDate <= checkInDate) {
                alert('Check-out date must be after check-in date');
                return;
            }
            
            const bookingDetails = {
                hotel: hotelName,
                pricePerNight: hotelPrice,
                checkIn: document.getElementById('checkInFormatted').textContent,
                checkOut: document.getElementById('checkOutFormatted').textContent,
                oneBedRooms: document.getElementById('oneBedCount').textContent,
                twoBedRooms: document.getElementById('twoBedCount').textContent,
                adults: document.getElementById('adultCount').textContent,
                children: document.getElementById('childCount').textContent,
                totalPrice: document.getElementById('totalPrice').textContent
            };
            
            // Store in localStorage for the payment page
            localStorage.setItem('bookingDetails', JSON.stringify(bookingDetails));
            
            // Show confirmation message
            const btn = document.getElementById('confirmBtn');
            const originalText = btn.innerHTML;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            btn.disabled = true;
            
            setTimeout(() => {
                alert(`Booking Confirmed!\n\nHotel: ${hotelName}\nCheck-in: ${bookingDetails.checkIn}\nCheck-out: ${bookingDetails.checkOut}\nTotal: ${bookingDetails.totalPrice}\n\nRedirecting to payment...`);
                window.location.href = 'payment.html';
            }, 2000);
        });
        
        // Set minimum date to today
        const today = new Date();
        const tomorrow = new Date(today);
        tomorrow.setDate(tomorrow.getDate() + 1);
        
        const formatDateForInput = (date) => {
            return date.toISOString().split('T')[0];
        };
        
        document.getElementById('checkInDate').min = formatDateForInput(today);
        document.getElementById('checkOutDate').min = formatDateForInput(tomorrow);
        
        // Set default dates (today and tomorrow)
        document.getElementById('checkInDate').value = formatDateForInput(today);
        document.getElementById('checkOutDate').value = formatDateForInput(tomorrow);
        updateDateDisplays();
    </script>
</body>
</html>